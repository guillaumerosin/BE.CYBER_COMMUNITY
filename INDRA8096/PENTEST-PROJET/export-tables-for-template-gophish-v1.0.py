import sqlite3

def fusionner_tables(nom_table_destination, chemin_templates_sqli):
    try:
        # Demander à l'utilisateur le chemin vers le fichier de base de données de destination
        chemin_base_de_donnees_destination = input("Entrez le chemin vers le fichier de base de données de destination : ")

        # Connexion à la base de données de destination
        connexion_destination = sqlite3.connect(chemin_base_de_donnees_destination)
        curseur_destination = connexion_destination.cursor()

        # Créer une nouvelle table dans la base de données de destination avec la même structure que la table source
        curseur_destination.execute(f"CREATE TABLE IF NOT EXISTS {nom_table_destination} (id INTEGER PRIMARY KEY AUTOINCREMENT, user_id BIGINT, name VARCHAR(255), subject VARCHAR(255), text VARCHAR(255), html VARCHAR(255), modified_date DATETIME, envelope_sender VARCHAR(255));")

        # Importer les données de la table source dans la nouvelle table de destination
        with open(chemin_templates_sqli, 'r') as file:
            curseur_destination.executescript(file.read())

        # Valider la transaction et fermer la connexion
        connexion_destination.commit()

    except sqlite3.Error as e:
        print(f"Erreur SQLite : {e}")

    finally:
        connexion_destination.close()

# Demander à l'utilisateur le nom de la table de destination et le chemin vers le fichier templates.sqli
nom_table_destination = input("Entrez le nom de la table de destination dans laquelle vous souhaitez fusionner les données : ")
chemin_templates_sqli = input("Entrez le chemin vers le fichier templates.sqli : ")

# Appeler la fonction en spécifiant le nom de la table de destination et le chemin vers le fichier templates.sqli
fusionner_tables(nom_table_destination, chemin_templates_sqli)
