import os

def merge_files(folder_path, output_folder, output_extension):
    # Vérifier si le dossier spécifié existe
    if not os.path.exists(folder_path):
        print("Le dossier spécifié n'existe pas.")
        return

    # Chemin complet du dossier de sortie
    output_folder_path = os.path.join(os.getcwd(), output_folder)

    # Créer le dossier de sortie s'il n'existe pas
    if not os.path.exists(output_folder_path):
        os.makedirs(output_folder_path)

    # Chemin complet du fichier de sortie
    output_file_path = os.path.join(output_folder_path, f"merged_templates.{output_extension}")

    # Ouvrir le fichier de sortie en mode écriture
    with open(output_file_path, "w") as outfile:
        # Initialiser l'ID du modèle
        template_id = 1

        # Parcourir tous les fichiers du dossier
        for filename in os.listdir(folder_path):
            # Vérifier si le fichier est un fichier HTML
            if filename.endswith(".html"):
                # Lire le contenu du fichier
                with open(os.path.join(folder_path, filename), "r") as infile:
                    content = infile.read()

                # Écrire une ligne au format requis dans le fichier de sortie
                outfile.write(f"{template_id}|1|{filename}|||{content}|2024-02-18 14:48:00.820796314+00:00|\n")

                # Incrémenter l'ID du modèle
                template_id += 1

    print("Le fusionnement des modèles est terminé.")

def main(folder_path, output_folder, output_extension):
    # Appeler la fonction pour fusionner les fichiers
    merge_files(folder_path, output_folder, output_extension)

if __name__ == "__main__":
    # Récupérer les informations nécessaires à partir des arguments de la ligne de commande
    folder_path = input("Veuillez entrer le chemin du dossier contenant les fichiers de modèles : ")
    output_folder = input("Veuillez entrer le nom du dossier de sortie : ")
    output_extension = input("Veuillez entrer l'extension souhaitée pour le fichier de sortie : ")

    # Appeler la fonction main avec les arguments récupérés
    main(folder_path, output_folder, output_extension)
